<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Comment Scraper</title>

    <!-- Bootstrap 5 for Styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Dark Theme -->
    <style>
        body {
            background-color: #121212;
            /* Dark background */
            color: #e0e0e0;
            /* Light text */
            font-family: 'Arial', sans-serif;
        }

        .container {
            margin-top: 30px;
        }

        h2,
        h3,
        h5 {
            color: #66ffcc;
            /* Light cyan color */
            text-align: center;
        }

        .form-control,
        .btn {
            background-color: #252525;
            color: #ffffff;
            border: 1px solid #666;
        }

        .form-control::placeholder {
            color: #aaaaaa;
        }

        .btn-primary {
            background-color: #008080;
            border: none;
        }

        .btn-primary:hover {
            background-color: #00b3b3;
        }

        .card {
            background-color: #1e1e1e;
            border: 1px solid #333;
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 255, 255, 0.2);
        }

        .chart-container {
            background-color: #222;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 255, 255, 0.3);
            text-align: center;
        }

        .list-group-item {
            background-color: #252525;
            border: 1px solid #444;
            color: #e0e0e0;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            padding: 10px;
            background-color: #181818;
            color: #ccc;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }
    </style>
</head>

<body>

    <div class="container">
        <!-- Page Header -->
        <h2>üé• YouTube Comment Scraper</h2>

        <!-- Progress Bar -->
        <div id="progress-container" class="mt-3" style="display:none;">
            <label for="progress-bar">Fetching comments...</label>
            <div class="progress" style="height: 25px;">
                <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated"
                    role="progressbar" style="width:0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div>

        <!-- Input Form -->
        <form method="POST" class="mt-4" onsubmit="showProgress()">
            <div class="form-group">
                <label for="video_link">Enter YouTube Video URL:</label>
                <input type="text" id="video_link" name="video_link" class="form-control"
                    placeholder="Paste video link here..." required>
            </div>
            <button type="submit" class="btn btn-primary btn-block mt-2">üîç Fetch Comments</button>
        </form>

        <!-- Message Display -->
        {% if message %}
        <div class="alert alert-info mt-3 text-center">{{ message }}</div>
        {% endif %}

        {% if warning_plot %}
        <div class="alert alert-warning mt-3 text-center">{{ warning_plot }}</div>
        {% endif %}

        {% if comments %}

        <!-- Sentiment Counts -->
        <div class="card mt-4">
            <h3 style="text-align: center;">üìà Sentiment Counts</h3>
            <div class="row mt-4">
                <div class="col-md-6 chart-container">
                    <p style="font-size: 1.5em; font-weight: bold;">‚úÖ Positive: <strong>{{ positive_count }}</strong>
                    </p>
                </div>
                <div class="col-md-6 chart-container">
                    <p style="font-size: 1.5em; font-weight: bold;">‚ûñ Neutral: <strong>{{ neutral_count }}</strong></p>
                </div>
                <div class="col-md-6 chart-container">
                    <p style="font-size: 1.5em; font-weight: bold;">‚ùå Negative: <strong>{{ negative_count }}</strong>
                    </p>
                </div>
                <div class="col-md-6 chart-container">
                    <p style="font-size: 1.5em; font-weight: bold;">üö´ Spam: <strong>{{ spam_count }}</strong></p>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="row mt-4">
            <div class="col-md-6 chart-container">
                <h3>üìä Sentiment Analysis</h3>
                <img src="{{ plot_data }}" alt="Sentiment Analysis Bar Plot">
            </div>

            <div class="col-md-6 chart-container">
                <h3>üåç Word Cloud</h3>
                <img src="{{ word_cloud_data }}" alt="Word Cloud">
            </div>
        </div>

        <br>

        <div class="row">
            <div class="col-md-6 chart-container">
                <h3>üî† Most Common Words</h3>
                <img src="{{ word_freq_plot }}" alt="Word Frequency Bar Plot">
            </div>

            <div class="col-md-6 chart-container">
                <h3>üìú Most Common Phrases</h3>
                <img src="{{ phrase_freq_plot }}" alt="Phrase Frequency Bar Plot">
            </div>
        </div>

        <br>

        <!-- Recent Comments (Moved to Bottom) -->
        <div class="card mt-4">
            <h3>üìù Recent 10 Comments</h3>
            <ul class="list-group">
                {% for comment in comments %}
                <li class="list-group-item">
                    <strong>{{ comment[0] }}</strong> <em>{{ comment[1] }}</em>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <script>
        function showProgress() {
            const container = document.getElementById('progress-container');
            const bar = document.getElementById('progress-bar');
            container.style.display = 'block';
            let width = 0;
            const interval = setInterval(() => {
                if (width >= 95) {
                    clearInterval(interval);
                } else {
                    width += 2;
                    bar.style.width = width + '%';
                    bar.setAttribute('aria-valuenow', width);
                }
            }, 200);
        }
    </script>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>